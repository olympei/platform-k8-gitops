# AWS Load Balancer Controller - Production Environment
# This file is for DIRECT chart deployment (without wrapper)
# Use this with: helm install aws-load-balancer-controller ./charts/aws-load-balancer-controller-1.14.1.tgz -f values-prod-direct.yaml

# Cluster configuration
clusterName: "my-eks-cluster-prod"  # REQUIRED: Replace with your EKS cluster name

# AWS Region
region: "us-east-1"  # REQUIRED: Replace with your AWS region

# VPC ID where the cluster is deployed
vpcId: "vpc-xxxxx"  # REQUIRED: Replace with your VPC ID

# Service Account configuration
serviceAccount:
  create: true
  name: aws-load-balancer-controller
  annotations:
    # IRSA annotation (used when authMethod is "irsa")
    eks.amazonaws.com/role-arn: "arn:aws:iam::ACCOUNT_ID:role/EKS-AWSLoadBalancerController-Role-prod"
    # Pod Identity annotation (used when authMethod is "pod-identity")
    eks.amazonaws.com/pod-identity-association-role-arn: "arn:aws:iam::ACCOUNT_ID:role/EKS-AWSLoadBalancerController-Role-prod"

# Replica count - Higher for production
replicaCount: 3

# Resource limits - Higher for production
resources:
  limits:
    cpu: 500m
    memory: 1Gi
  requests:
    cpu: 200m
    memory: 500Mi

# Enable Shield, WAF for production
enableShield: true
enableWaf: false
enableWafv2: true

# Logging
logLevel: info

# Node selector - Deploy to specific node groups
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity rules - Spread across availability zones
affinity:
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
            - key: app.kubernetes.io/name
              operator: In
              values:
                - aws-load-balancer-controller
        topologyKey: topology.kubernetes.io/zone
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - aws-load-balancer-controller
          topologyKey: kubernetes.io/hostname

# Default tags for AWS resources
defaultTags:
  Environment: prod
  ManagedBy: eks-load-balancer-controller
  Team: platform
  CostCenter: production

# Ingress class configuration
ingressClass: alb

# Additional configuration
enableBackendSecurityGroup: true

# Priority class for production
priorityClassName: system-cluster-critical

# Default SSL/TLS certificate for ALBs
# This certificate will be used by default for HTTPS listeners
# You can override this per-Ingress using annotations
defaultSSLCertificate:
  # ARN of the default SSL certificate in ACM (AWS Certificate Manager)
  # Replace with your ACM certificate ARN
  arn: "arn:aws:acm:us-east-1:ACCOUNT_ID:certificate/CERTIFICATE_ID"
  
# SSL Policy for ALBs
# Use a more secure policy for production
# Options: ELBSecurityPolicy-2016-08, ELBSecurityPolicy-TLS-1-2-2017-01, 
#          ELBSecurityPolicy-TLS-1-2-Ext-2018-06, ELBSecurityPolicy-FS-1-2-Res-2019-08,
#          ELBSecurityPolicy-TLS-1-3-2021-06 (recommended for production)
sslPolicy: "ELBSecurityPolicy-TLS-1-2-Ext-2018-06"

# Webhook TLS configuration
# The controller uses a webhook for validating and mutating resources
# TLS certificates can be provided via an existing secret
webhookTLS:
  # Use an existing Kubernetes secret for TLS certificates
  # If not specified, certificates will be auto-generated
  existingSecret: "aws-load-balancer-webhook-tls"
  
  # Use cert-manager to manage webhook certificates (recommended for production)
  # If false and no existingSecret, self-signed certificates will be generated
  useCertManager: false
  
  # Certificate duration (only applies when auto-generating)
  # Default: 365 days
  certDuration: 8760h  # 1 year
  
  # Certificate renewal before expiration (only applies when auto-generating)
  # Default: 30 days before expiration
  certRenewalBefore: 720h  # 30 days

# Webhook service configuration
webhookService:
  type: ClusterIP
  port: 9443
  targetPort: 9443

# Webhook configuration
webhook:
  # Webhook port
  port: 9443
  
  # Webhook timeout
  timeoutSeconds: 10
  
  # Failure policy (Fail or Ignore)
  # Use Fail for production to prevent invalid resources
  failurePolicy: Fail
  
  # Namespace selector for webhook
  namespaceSelector: {}
  
  # Object selector for webhook
  objectSelector: {}
